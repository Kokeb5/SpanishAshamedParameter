<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRIKEB - Application de Communication</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="chat-app">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2><i id="appIcon" class="fas fa-comments"></i> PRIKEB</h2>
                <div class="header-controls">
                    <button id="iconSelector" class="theme-btn" title="Changer l'icÃ´ne"><i class="fas fa-palette"></i></button>
                    <button id="themeToggle" class="theme-btn" title="Changer le thÃ¨me"><i class="fas fa-moon"></i></button>
                </div>
            </div>
            
            <!-- Profil utilisateur -->
            <div class="user-profile" id="userProfile" style="display: none;">
                <div class="profile-info">
                    <div class="avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-details">
                        <h3 id="currentUsername"></h3>
                        <span class="status online">En ligne</span>
                    </div>
                </div>
            </div>
            
            <!-- Authentification -->
            <div class="auth-section" id="authSection">
                <!-- Connexion -->
                <div class="login-form" id="loginForm">
                    <h4>Se connecter</h4>
                    <input type="email" id="loginEmail" placeholder="Votre email" required>
                    <input type="password" id="loginPassword" placeholder="Mot de passe" required>
                    <div class="auth-status" id="loginStatus"></div>
                    <button id="loginBtn" class="primary-btn">Se connecter</button>
                    <p class="auth-switch">Pas de compte ? <a href="#" id="showRegister">S'inscrire</a></p>
                </div>
                
                <!-- Inscription -->
                <div class="register-form" id="registerForm" style="display: none;">
                    <h4>CrÃ©er un compte</h4>
                    <div class="username-input-container">
                        <span class="username-prefix">@</span>
                        <input type="text" id="registerUsername" placeholder="nom_utilisateur" maxlength="19" required>
                    </div>
                    <input type="email" id="registerEmail" placeholder="Votre email" required>
                    <input type="password" id="registerPassword" placeholder="Mot de passe (6 caractÃ¨res min)" required>
                    <div class="auth-status" id="registerStatus"></div>
                    <button id="registerBtn" class="primary-btn">CrÃ©er le compte</button>
                    <p class="auth-switch">DÃ©jÃ  un compte ? <a href="#" id="showLogin">Se connecter</a></p>
                </div>
            </div>
            
            <!-- Salles de chat -->
            <div class="rooms-section" id="roomsSection" style="display: none;">
                <h3><i class="fas fa-hashtag"></i> Salles</h3>
                <div class="rooms-list" id="roomsList">
                    <div class="room-item active" data-room="general">
                        <i class="fas fa-hashtag"></i>
                        <span>gÃ©nÃ©ral</span>
                        <span class="room-count">0</span>
                    </div>
                </div>
                <button id="createRoomBtn" class="create-btn"><i class="fas fa-plus"></i> Nouvelle salle</button>
            </div>
            
            <!-- Utilisateurs en ligne -->
            <div class="users-section" id="usersSection" style="display: none;">
                <div class="users-header">
                    <h3><i class="fas fa-users"></i> Utilisateurs</h3>
                    <button id="searchUsersBtn" class="search-users-btn" title="Rechercher un utilisateur">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                
                <!-- Barre de recherche d'utilisateurs -->
                <div class="user-search-container" id="userSearchContainer" style="display: none;">
                    <div class="user-search-input">
                        <span class="search-prefix">@</span>
                        <input type="text" id="userSearchInput" placeholder="nom_utilisateur" maxlength="19">
                        <button id="closeUserSearch"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="search-results" id="searchResults"></div>
                </div>
                
                <div class="users-list" id="usersList"></div>
            </div>
        </div>
        
        <!-- Zone de chat principale -->
        <div class="main-chat">
            <div class="chat-header">
                <h2 id="currentRoom"># gÃ©nÃ©ral</h2>
                <div class="chat-actions">
                    <button id="searchBtn" class="action-btn"><i class="fas fa-search"></i></button>
                    <button id="settingsBtn" class="action-btn"><i class="fas fa-cog"></i></button>
                </div>
            </div>
            
            <!-- Zone de recherche -->
            <div class="search-bar" id="searchBar" style="display: none;">
                <input type="text" id="searchInput" placeholder="Rechercher dans les messages...">
                <button id="closeSearch"><i class="fas fa-times"></i></button>
            </div>
            
            <!-- Messages -->
            <div class="messages-container" id="messagesContainer">
                <div id="messages"></div>
                <div class="typing-indicator" id="typingIndicator" style="display: none;">
                    <span id="typingUsers"></span> en train d'Ã©crire...
                </div>
            </div>
            
            <!-- Zone de saisie -->
            <div class="message-input-area">
                <div class="input-toolbar">
                    <button id="emojiBtn" class="toolbar-btn"><i class="fas fa-smile"></i></button>
                    <button id="fileBtn" class="toolbar-btn"><i class="fas fa-paperclip"></i></button>
                    <button id="imageBtn" class="toolbar-btn"><i class="fas fa-image"></i></button>
                </div>
                <div class="message-input">
                    <input type="text" id="messageInput" placeholder="Tapez votre message..." maxlength="1000" disabled>
                    <button id="sendBtn" class="send-btn" disabled><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal pour crÃ©er une salle -->
    <div class="modal" id="createRoomModal">
        <div class="modal-content">
            <h3>CrÃ©er une nouvelle salle</h3>
            <input type="text" id="newRoomName" placeholder="Nom de la salle" maxlength="50">
            <textarea id="newRoomDescription" placeholder="Description (optionnel)" maxlength="200"></textarea>
            <div class="modal-actions">
                <button id="cancelCreateRoom">Annuler</button>
                <button id="confirmCreateRoom" class="primary-btn">CrÃ©er</button>
            </div>
        </div>
    </div>
    
    <!-- SÃ©lecteur d'emojis -->
    <div class="emoji-picker" id="emojiPicker" style="display: none;">
        <div class="emoji-categories">
            <div class="emoji-category">
                <h4>Smileys</h4>
                <div class="emoji-grid">
                    <span class="emoji-item" data-emoji="ğŸ˜€">ğŸ˜€</span>
                    <span class="emoji-item" data-emoji="ğŸ˜ƒ">ğŸ˜ƒ</span>
                    <span class="emoji-item" data-emoji="ğŸ˜„">ğŸ˜„</span>
                    <span class="emoji-item" data-emoji="ğŸ˜">ğŸ˜</span>
                    <span class="emoji-item" data-emoji="ğŸ˜†">ğŸ˜†</span>
                    <span class="emoji-item" data-emoji="ğŸ˜…">ğŸ˜…</span>
                    <span class="emoji-item" data-emoji="ğŸ˜‚">ğŸ˜‚</span>
                    <span class="emoji-item" data-emoji="ğŸ¤£">ğŸ¤£</span>
                    <span class="emoji-item" data-emoji="ğŸ˜Š">ğŸ˜Š</span>
                    <span class="emoji-item" data-emoji="ğŸ˜‡">ğŸ˜‡</span>
                    <span class="emoji-item" data-emoji="ğŸ™‚">ğŸ™‚</span>
                    <span class="emoji-item" data-emoji="ğŸ™ƒ">ğŸ™ƒ</span>
                    <span class="emoji-item" data-emoji="ğŸ˜‰">ğŸ˜‰</span>
                    <span class="emoji-item" data-emoji="ğŸ˜Œ">ğŸ˜Œ</span>
                    <span class="emoji-item" data-emoji="ğŸ˜">ğŸ˜</span>
                    <span class="emoji-item" data-emoji="ğŸ¥°">ğŸ¥°</span>
                    <span class="emoji-item" data-emoji="ğŸ˜˜">ğŸ˜˜</span>
                    <span class="emoji-item" data-emoji="ğŸ˜—">ğŸ˜—</span>
                    <span class="emoji-item" data-emoji="ğŸ˜™">ğŸ˜™</span>
                    <span class="emoji-item" data-emoji="ğŸ˜š">ğŸ˜š</span>
                    <span class="emoji-item" data-emoji="ğŸ˜‹">ğŸ˜‹</span>
                    <span class="emoji-item" data-emoji="ğŸ˜›">ğŸ˜›</span>
                    <span class="emoji-item" data-emoji="ğŸ˜">ğŸ˜</span>
                    <span class="emoji-item" data-emoji="ğŸ˜œ">ğŸ˜œ</span>
                </div>
            </div>
            <div class="emoji-category">
                <h4>Gestes</h4>
                <div class="emoji-grid">
                    <span class="emoji-item" data-emoji="ğŸ‘">ğŸ‘</span>
                    <span class="emoji-item" data-emoji="ğŸ‘">ğŸ‘</span>
                    <span class="emoji-item" data-emoji="ğŸ‘Œ">ğŸ‘Œ</span>
                    <span class="emoji-item" data-emoji="âœŒï¸">âœŒï¸</span>
                    <span class="emoji-item" data-emoji="ğŸ¤">ğŸ¤</span>
                    <span class="emoji-item" data-emoji="ğŸ¤Ÿ">ğŸ¤Ÿ</span>
                    <span class="emoji-item" data-emoji="ğŸ¤˜">ğŸ¤˜</span>
                    <span class="emoji-item" data-emoji="ğŸ¤™">ğŸ¤™</span>
                    <span class="emoji-item" data-emoji="ğŸ‘ˆ">ğŸ‘ˆ</span>
                    <span class="emoji-item" data-emoji="ğŸ‘‰">ğŸ‘‰</span>
                    <span class="emoji-item" data-emoji="ğŸ‘†">ğŸ‘†</span>
                    <span class="emoji-item" data-emoji="ğŸ‘‡">ğŸ‘‡</span>
                    <span class="emoji-item" data-emoji="â˜ï¸">â˜ï¸</span>
                    <span class="emoji-item" data-emoji="âœ‹">âœ‹</span>
                    <span class="emoji-item" data-emoji="ğŸ¤š">ğŸ¤š</span>
                    <span class="emoji-item" data-emoji="ğŸ–ï¸">ğŸ–ï¸</span>
                    <span class="emoji-item" data-emoji="ğŸ––">ğŸ––</span>
                    <span class="emoji-item" data-emoji="ğŸ‘‹">ğŸ‘‹</span>
                    <span class="emoji-item" data-emoji="ğŸ¤">ğŸ¤</span>
                    <span class="emoji-item" data-emoji="ğŸ‘">ğŸ‘</span>
                    <span class="emoji-item" data-emoji="ğŸ™Œ">ğŸ™Œ</span>
                    <span class="emoji-item" data-emoji="ğŸ‘">ğŸ‘</span>
                    <span class="emoji-item" data-emoji="ğŸ¤²">ğŸ¤²</span>
                    <span class="emoji-item" data-emoji="ğŸ™">ğŸ™</span>
                </div>
            </div>
            <div class="emoji-category">
                <h4>CÅ“urs</h4>
                <div class="emoji-grid">
                    <span class="emoji-item" data-emoji="â¤ï¸">â¤ï¸</span>
                    <span class="emoji-item" data-emoji="ğŸ§¡">ğŸ§¡</span>
                    <span class="emoji-item" data-emoji="ğŸ’›">ğŸ’›</span>
                    <span class="emoji-item" data-emoji="ğŸ’š">ğŸ’š</span>
                    <span class="emoji-item" data-emoji="ğŸ’™">ğŸ’™</span>
                    <span class="emoji-item" data-emoji="ğŸ’œ">ğŸ’œ</span>
                    <span class="emoji-item" data-emoji="ğŸ–¤">ğŸ–¤</span>
                    <span class="emoji-item" data-emoji="ğŸ¤">ğŸ¤</span>
                    <span class="emoji-item" data-emoji="ğŸ¤">ğŸ¤</span>
                    <span class="emoji-item" data-emoji="ğŸ’”">ğŸ’”</span>
                    <span class="emoji-item" data-emoji="â£ï¸">â£ï¸</span>
                    <span class="emoji-item" data-emoji="ğŸ’•">ğŸ’•</span>
                    <span class="emoji-item" data-emoji="ğŸ’">ğŸ’</span>
                    <span class="emoji-item" data-emoji="ğŸ’“">ğŸ’“</span>
                    <span class="emoji-item" data-emoji="ğŸ’—">ğŸ’—</span>
                    <span class="emoji-item" data-emoji="ğŸ’–">ğŸ’–</span>
                    <span class="emoji-item" data-emoji="ğŸ’˜">ğŸ’˜</span>
                    <span class="emoji-item" data-emoji="ğŸ’">ğŸ’</span>
                    <span class="emoji-item" data-emoji="ğŸ’Ÿ">ğŸ’Ÿ</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- SÃ©lecteur d'icÃ´nes -->
    <div class="icon-selector-modal" id="iconSelectorModal">
        <div class="modal-content">
            <h3>Choisir l'icÃ´ne de l'application</h3>
            <div class="icon-options">
                <div class="icon-option" data-icon="fas fa-comments" data-name="Chat">
                    <i class="fas fa-comments"></i>
                    <span>Chat</span>
                </div>
                <div class="icon-option" data-icon="fas fa-cloud-sun" data-name="MÃ©tÃ©o">
                    <i class="fas fa-cloud-sun"></i>
                    <span>MÃ©tÃ©o</span>
                </div>
                <div class="icon-option" data-icon="fas fa-sticky-note" data-name="Note">
                    <i class="fas fa-sticky-note"></i>
                    <span>Note</span>
                </div>
                <div class="icon-option" data-icon="fas fa-calendar-alt" data-name="Agenda">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Agenda</span>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelIconChange">Annuler</button>
                <button id="confirmIconChange" class="primary-btn">Confirmer</button>
            </div>
        </div>
    </div>
    
    <!-- Input files cachÃ©s -->
    <input type="file" id="fileInput" style="display: none;" accept="*/*">
    <input type="file" id="imageInput" style="display: none;" accept="image/*">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
</body>
</html>